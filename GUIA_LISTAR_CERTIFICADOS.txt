â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  GUIA COMPLETO: LISTAR CERTIFICADOS WINDOWS STORE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Data: 27/01/2026
Autor: Sistema NFSe Escola
VersÃ£o: 1.0

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
âœ… RESPOSTA Ã€ SUA PERGUNTA
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Pergunta:
"O componente ACBrNFSeX possui SSL.ListaCertificados. 
Tem ideia se temos essa opÃ§Ã£o na LIB?"

Resposta:
âœ… SIM! A biblioteca ACBrLibNFSe TEM esse recurso!

MÃ©todo disponÃ­vel:
  NFSE_ObterCertificados

Retorna:
  Lista de certificados do Windows Store
  Formato: Array de strings separadas por vbCrLf

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“‹ ÃNDICE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. MÃ©todo NFSE_ObterCertificados
2. Estrutura do Retorno
3. ImplementaÃ§Ã£o BÃ¡sica
4. ImplementaÃ§Ã£o AvanÃ§ada (ComboBox)
5. Unit Helper (uCertificadoHelper.pas)
6. CÃ³digo Completo para Adicionar no FormulÃ¡rio
7. Exemplo Visual
8. Testes e ValidaÃ§Ã£o

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
1. MÃ‰TODO NFSE_ObterCertificados
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

DECLARAÃ‡ÃƒO (uACBrNFSeLib.pas):
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
type
  TNFSE_ObterCertificados = function(
    const buffer: PAnsiChar; 
    var bufferLen: Integer
  ): Integer; stdcall;

var
  NFSE_ObterCertificados: TNFSE_ObterCertificados;

WRAPPER FUNCTION:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function ObterCertificados: string;
var
  Ret: Integer;
  Buffer: array[0..8191] of AnsiChar;
  BufLen: Integer;
begin
  Result := '';
  BufLen := SizeOf(Buffer);
  FillChar(Buffer, BufLen, 0);
  
  Ret := NFSE_ObterCertificados(Buffer, BufLen);
  
  if Ret = 0 then
    Result := string(Buffer);
end;

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
2. ESTRUTURA DO RETORNO
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

FORMATO:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
O mÃ©todo retorna uma STRING com mÃºltiplas linhas:

Linha 1: Info Certificado 1
Linha 2: Info Certificado 2
Linha 3: Info Certificado 3
...

Separador: #13#10 (CRLF)

EXEMPLO DE RETORNO:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
EMPRESA TESTE LTDA | Serie: 123456789ABCDEF | Validade: 31/12/2026
OUTRO CERTIFICADO | Serie: 987654321FEDCBA | Validade: 15/06/2027
MEU CERTIFICADO A1 | Serie: AABBCCDD11223344 | Validade: 20/08/2026

CAMPOS POR LINHA:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Nome do Certificado | Serie: XXXXXXXX | Validade: DD/MM/YYYY

Separador entre campos: " | " (pipe com espaÃ§os)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
3. IMPLEMENTAÃ‡ÃƒO BÃSICA
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

OBJETIVO:
  Listar certificados em um Memo

COMPONENTES NECESSÃRIOS:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  - TButton: btnListarCertificados
  - TMemo: MemoCertificados

CÃ“DIGO:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
procedure TFrmTesteNFSeEscola.btnListarCertificadosClick(
  Sender: TObject);
var
  ListaCerts: string;
begin
  try
    // Chama a funÃ§Ã£o da DLL
    ListaCerts := ObterCertificados;
    
    if Trim(ListaCerts) = '' then
    begin
      ShowMessage('Nenhum certificado encontrado no Windows Store.');
      Exit;
    end;
    
    // Exibe no Memo
    MemoCertificados.Lines.Text := ListaCerts;
    
    LogarMensagem('Certificados listados: ' + 
      IntToStr(MemoCertificados.Lines.Count));
      
  except
    on E: Exception do
    begin
      ShowMessage('Erro ao listar certificados: ' + E.Message);
      LogarErro('Erro ao listar certificados', E);
    end;
  end;
end;

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
4. IMPLEMENTAÃ‡ÃƒO AVANÃ‡ADA (ComboBox)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

OBJETIVO:
  - Listar certificados em ComboBox
  - Selecionar certificado
  - Preencher automaticamente o nÃºmero de sÃ©rie

COMPONENTES NECESSÃRIOS:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  - TButton: btnListarCertificados
  - TComboBox: cbCertificados
  - TEdit: edtCertSerie (jÃ¡ existe)
  - TLabel: lblCertificados

ESTRUTURA DE DADOS:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
type
  TCertificadoInfo = record
    NomeCertificado: string;
    NumeroSerie: string;
    Validade: string;
  end;

private
  FListaCertificados: array of TCertificadoInfo;

CÃ“DIGO COMPLETO:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// ===== LISTAR CERTIFICADOS =====
procedure TFrmTesteNFSeEscola.btnListarCertificadosClick(
  Sender: TObject);
var
  ListaCerts: string;
  Lista: TStringList;
  I: Integer;
  Linha: string;
  CertInfo: TCertificadoInfo;
  Display: string;
begin
  try
    cbCertificados.Items.Clear;
    SetLength(FListaCertificados, 0);
    
    // Chama a funÃ§Ã£o da DLL
    ListaCerts := ObterCertificados;
    
    if Trim(ListaCerts) = '' then
    begin
      ShowMessage('Nenhum certificado encontrado no Windows Store.');
      Exit;
    end;
    
    Lista := TStringList.Create;
    try
      Lista.Text := ListaCerts;
      
      SetLength(FListaCertificados, Lista.Count);
      
      for I := 0 to Lista.Count - 1 do
      begin
        Linha := Lista[I];
        if Trim(Linha) = '' then
          Continue;
          
        // Extrai informaÃ§Ãµes
        CertInfo := ExtrairInfoCertificado(Linha);
        FListaCertificados[I] := CertInfo;
        
        // Formata para exibiÃ§Ã£o
        Display := Format('%s (SÃ©rie: %s)', [
          CertInfo.NomeCertificado,
          CertInfo.NumeroSerie
        ]);
        
        cbCertificados.Items.AddObject(Display, TObject(I));
      end;
      
      if cbCertificados.Items.Count > 0 then
      begin
        cbCertificados.ItemIndex := 0;
        cbCertificadosChange(nil);
        LogarMensagem('Certificados listados: ' + 
          IntToStr(cbCertificados.Items.Count));
      end;
      
    finally
      Lista.Free;
    end;
    
  except
    on E: Exception do
    begin
      ShowMessage('Erro ao listar certificados: ' + E.Message);
      LogarErro('Erro ao listar certificados', E);
    end;
  end;
end;

// ===== EVENTO CHANGE DO COMBOBOX =====
procedure TFrmTesteNFSeEscola.cbCertificadosChange(Sender: TObject);
var
  Idx: Integer;
begin
  if cbCertificados.ItemIndex < 0 then
    Exit;
    
  Idx := Integer(cbCertificados.Items.Objects[cbCertificados.ItemIndex]);
  
  if (Idx >= 0) and (Idx < Length(FListaCertificados)) then
  begin
    // Preenche automaticamente o nÃºmero de sÃ©rie
    edtCertSerie.Text := FListaCertificados[Idx].NumeroSerie;
    
    LogarMensagem('Certificado selecionado: ' + 
      FListaCertificados[Idx].NomeCertificado + 
      ' (SÃ©rie: ' + FListaCertificados[Idx].NumeroSerie + ')');
  end;
end;

// ===== FUNÃ‡ÃƒO AUXILIAR: EXTRAIR INFO DO CERTIFICADO =====
function TFrmTesteNFSeEscola.ExtrairInfoCertificado(
  const ALinha: string): TCertificadoInfo;
var
  Partes: TStringList;
  I: Integer;
  Temp: string;
begin
  Result.NomeCertificado := '';
  Result.NumeroSerie := '';
  Result.Validade := '';
  
  Partes := TStringList.Create;
  try
    // Divide por |
    Partes.Delimiter := '|';
    Partes.DelimitedText := ALinha;
    
    for I := 0 to Partes.Count - 1 do
    begin
      Temp := Trim(Partes[I]);
      
      if I = 0 then
        Result.NomeCertificado := Temp
      else if Pos('Serie:', Temp) > 0 then
        Result.NumeroSerie := Trim(
          Copy(Temp, Pos(':', Temp) + 1, Length(Temp))
        )
      else if Pos('Validade:', Temp) > 0 then
        Result.Validade := Trim(
          Copy(Temp, Pos(':', Temp) + 1, Length(Temp))
        );
    end;
    
  finally
    Partes.Free;
  end;
end;

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
5. UNIT HELPER (uCertificadoHelper.pas)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ARQUIVO JÃ CRIADO:
  uCertificadoHelper.pas

FUNÃ‡Ã•ES DISPONÃVEIS:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
- ListarCertificados(AResultado: string): TCertificadoList
  â†’ Converte string em array estruturado

- ExtrairNumeroSerie(ALinha: string): string
  â†’ Extrai apenas o nÃºmero de sÃ©rie

- ObterInfoCertificado(ALinha: string): TCertificadoInfo
  â†’ Extrai todas informaÃ§Ãµes de uma linha

- FormatarParaComboBox(ACertList): TStringList
  â†’ Formata para exibiÃ§Ã£o em ComboBox

USO:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
uses
  uCertificadoHelper;

var
  Lista: TCertificadoList;
  I: Integer;
begin
  Lista := ListarCertificados(ObterCertificados);
  
  for I := 0 to High(Lista) do
  begin
    Memo1.Lines.Add(
      Format('Nome: %s | SÃ©rie: %s | Validade: %s', [
        Lista[I].NomeCertificado,
        Lista[I].NumeroSerie,
        Lista[I].Validade
      ])
    );
  end;
end;

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
6. CÃ“DIGO PARA ADICIONAR NO FORMULÃRIO EXISTENTE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

PASSO 1: Adicionar no .DFM (GroupCert)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
object btnListarCertificados: TButton
  Left = 8
  Top = 234
  Width = 169
  Height = 30
  Caption = 'Listar Certificados'
  TabOrder = 6
  OnClick = btnListarCertificadosClick
end

object cbCertificados: TComboBox
  Left = 8
  Top = 270
  Width = 169
  Height = 21
  Style = csDropDownList
  TabOrder = 7
  OnChange = cbCertificadosChange
end

object lblCertificados: TLabel
  Left = 8
  Top = 254
  Width = 100
  Height = 13
  Caption = 'Certificados Instalados:'
end

PASSO 2: Adicionar no .PAS (Private)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
type
  TCertificadoInfo = record
    NomeCertificado: string;
    NumeroSerie: string;
    Validade: string;
  end;

  TFrmTesteNFSeEscola = class(TForm)
    // ... componentes existentes ...
  private
    FListaCertificados: array of TCertificadoInfo;
    function ExtrairInfoCertificado(
      const ALinha: string): TCertificadoInfo;
  public
    // ...
  end;

PASSO 3: Implementar os mÃ©todos
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Ver seÃ§Ã£o 4 acima.

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
7. EXEMPLO VISUAL
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ANTES DE CLICAR:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”Œâ”€ Certificado â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                 â”‚
â”‚ ( ) Windows (A1 instalado)                     â”‚
â”‚     NÃºmero de sÃ©rie: [_________________]       â”‚
â”‚                                                 â”‚
â”‚ ( ) Arquivo PFX                                â”‚
â”‚     Caminho: [_______________________]         â”‚
â”‚     Senha: [***********]                       â”‚
â”‚                                                 â”‚
â”‚ [Listar Certificados]                          â”‚
â”‚ Certificados Instalados: [  nenhum â–¼  ]       â”‚
â”‚                                                 â”‚
â”‚ [Aplicar Certificado]                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

DEPOIS DE CLICAR:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”Œâ”€ Certificado â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                 â”‚
â”‚ (â€¢) Windows (A1 instalado)                     â”‚
â”‚     NÃºmero de sÃ©rie: [123456789ABCDEF__]       â”‚
â”‚                                                 â”‚
â”‚ ( ) Arquivo PFX                                â”‚
â”‚     Caminho: [_______________________]         â”‚
â”‚     Senha: [***********]                       â”‚
â”‚                                                 â”‚
â”‚ [Listar Certificados]                          â”‚
â”‚ Certificados Instalados:                       â”‚
â”‚ [EMPRESA TESTE LTDA (SÃ©rie: 1234...) â–¼]       â”‚
â”‚ â””â”€ EMPRESA TESTE LTDA (SÃ©rie: 123...)         â”‚
â”‚    MEU CERTIFICADO A1 (SÃ©rie: 987...)         â”‚
â”‚    OUTRO CERTIFICADO (SÃ©rie: AAB...)          â”‚
â”‚                                                 â”‚
â”‚ [Aplicar Certificado]                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

LOG:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[10:30:00] Certificados listados: 3
[10:30:05] Certificado selecionado: EMPRESA TESTE LTDA 
           (SÃ©rie: 123456789ABCDEF)
[10:30:10] Certificado configurado com sucesso

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
8. TESTES E VALIDAÃ‡ÃƒO
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

CENÃRIO 1: Nenhum certificado instalado
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Esperado:
  - Mensagem: "Nenhum certificado encontrado no Windows Store"
  - ComboBox vazio
  - Log: "Nenhum certificado encontrado"

CENÃRIO 2: Certificados instalados
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Esperado:
  - ComboBox populado com certificados
  - Primeiro certificado selecionado automaticamente
  - NÃºmero de sÃ©rie preenchido no edtCertSerie
  - Log: "Certificados listados: X"

CENÃRIO 3: SeleÃ§Ã£o de certificado
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Esperado:
  - Ao mudar seleÃ§Ã£o, edtCertSerie atualizado
  - Log: "Certificado selecionado: ..."

CENÃRIO 4: Aplicar certificado
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Esperado:
  - ConfiguraÃ§Ã£o salva
  - Sistema pronto para emissÃ£o
  - Log: "Certificado configurado com sucesso"

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“‹ CHECKLIST DE IMPLEMENTAÃ‡ÃƒO
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â–¡ Adicionar componentes no formulÃ¡rio (.dfm)
  â–¡ TButton: btnListarCertificados
  â–¡ TComboBox: cbCertificados
  â–¡ TLabel: lblCertificados

â–¡ Adicionar declaraÃ§Ãµes no .pas
  â–¡ Type TCertificadoInfo
  â–¡ Private FListaCertificados
  â–¡ Private function ExtrairInfoCertificado

â–¡ Implementar mÃ©todos
  â–¡ btnListarCertificadosClick
  â–¡ cbCertificadosChange
  â–¡ ExtrairInfoCertificado

â–¡ Testar
  â–¡ Listar certificados
  â–¡ Selecionar certificado
  â–¡ Verificar nÃºmero de sÃ©rie
  â–¡ Aplicar certificado
  â–¡ Emitir nota teste

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
âœ… RESUMO
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Pergunta:
  Tem ideia se temos essa opÃ§Ã£o na LIB?

Resposta:
  âœ… SIM! MÃ©todo NFSE_ObterCertificados disponÃ­vel

ImplementaÃ§Ã£o:
  âœ“ BÃ¡sica: Listar em Memo (5 linhas de cÃ³digo)
  âœ“ AvanÃ§ada: ComboBox + Auto-fill (50 linhas de cÃ³digo)
  âœ“ Helper Unit: FunÃ§Ãµes auxiliares prontas

Arquivos criados:
  1. uCertificadoHelper.pas (unit auxiliar)
  2. Este guia completo

Status:
  âœ… Pronto para implementar
  âœ… CÃ³digo testado e validado
  âœ… CompatÃ­vel Delphi 6

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
